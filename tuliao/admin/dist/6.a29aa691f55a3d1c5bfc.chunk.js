webpackJsonp([6],{350:function(e,r,t){"use strict";function o(e){l||t(397)}Object.defineProperty(r,"__esModule",{value:!0});var s=t(399),n=t.n(s),a=t(400),i=t.n(a),l=!1,c=t(3),d=o,f=c(n.a,i.a,!1,d,"data-v-012cdff4",null);f.options.__file="src\\views\\html\\system\\role.vue",f.esModule&&Object.keys(f.esModule).some(function(e){return"default"!==e&&"__"!==e.substr(0,2)})&&console.error("named exports are not supported in *.vue files."),r.default=f.exports},397:function(e,r,t){var o=t(398);"string"==typeof o&&(o=[[e.i,o,""]]),o.locals&&(e.exports=o.locals);t(17)("3e6277d4",o,!1)},398:function(e,r,t){r=e.exports=t(16)(void 0),r.push([e.i,"\n.permissionWrapper[data-v-012cdff4] {\n  position: absolute;\n  z-index: 10;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  background-color: rgba(0, 0, 0, 0.2);\n}\n.permissionWrapper p[data-v-012cdff4] {\n  position: absolute;\n  top: 50%;\n  left: 45%;\n  transform: -50%;\n  font-size: 25px;\n  font-style: '\\9ED1\\4F53';\n  text-align: center;\n  color: #fff;\n}\n",""])},399:function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var o=t(122),s=t(36);r.default={data:function(){var e=this;return{pageNum:null,currentPageIdx:1,permissionWrapper:!1,ifLoading:!0,deleteRoleArr:[],delRole:!1,deleteRoleID:null,fixedRolePermission:[],submitArr:[],allPermission:[{title:"全部权限",expand:!0,selected:!0,children:[{title:"parent 1-1",expand:!0,children:[{title:"leaf 1-1-2"}]},{title:"parent 1-2",expand:!0,children:[{title:"leaf 1-2-1"},{title:"leaf 1-2-1"}]}]}],roleId:null,showAddRole:!1,showForm:!1,formValidate:{name:null,roleDscrp:null},ruleValidate:{name:[{required:!0,message:"角色名称不能为空!",trigger:"blur"}]},column_list:[{title:"ID",key:"roleId",width:80},{title:"角色名称",key:"roleName"},{title:"备注",key:"remark"},{title:"操作",render:function(r,t){return r("div",[r("Button",{props:{type:"info",size:"small"},style:{marginRight:"5px"},on:{click:function(){e.permissions=[],e.fixedRolePermission=[],e.showForm=!0,e.filterPermission=[],e.roleId=t.row.id,e.formValidate.name=t.row.role,e.formValidate.roleDscrp=t.row.description;var r=JSON.parse((0,s.getStore)("allPermission"));r.forEach(function(e){e.checked=!1}),(0,o.queryRolePermission)({roleId:t.row.id}).then(function(t){if(t.code)e.$Message.error("数据获取异常！");else{var o=[];t.data.forEach(function(e){e.submenus.forEach(function(e){o.push({id:e.id,parentId:e.parentId})})}),r.forEach(function(e){e.children.forEach(function(e){o.find(function(r){return r.id===e.id})&&(e.checked=!0)})}),e.permissions=r}})}}},"修改"),r("Button",{props:{type:"error",size:"small"},on:{click:function(){e.deleteRoleID=t.row.roleId,e.delRoleBtn()}}},"删除")])}}],permissions:[],userpage:[]}},methods:{changePage:function(e){this.currentPageIdx=e,this.refreshPage({pageNo:e,pageSize:10})},deleteRole:function(){var e=this;(0,o.deleteRole)({roleId:this.deleteRoleID}).then(function(r){200==r.status?(e.$Message.success("删除成功！"),e.refreshPage()):e.$Message.error(r.msg)})},delRoleBtn:function(){this.delRole=!0},addRoleBtn:function(){var e=this;this.submitArr=[],this.formValidate.roleDscrp=this.formValidate.name=null,this.showAddRole=!0,this.allPermission=JSON.parse((0,s.getStore)("allPermission")),this.allPermission.forEach(function(r,t){e.submitArr.push(r.id),void 0!==r.children&&r.children.forEach(function(r){e.submitArr.push(r.id)})})},addRoleTree:function(e){console.log("www",e)},addRole:function(){var e=this;if(""!==this.formValidate.name&&this.formValidate.name){this.permissionWrapper=!0;var r={role:this.formValidate.name,description:this.formValidate.roleDscrp,permissions:this.submitArr};(0,o.addAuditRole)(r).then(function(r){r.code?e.$Message.error(r.message):(e.$Message.success("操作成功！"),e.refreshPage()),e.permissionWrapper=!1}).catch(function(e){console.log(e)})}else this.$Message.warning("角色名称不能为空！")},selectArrayFn:function(e){var r=[];e.forEach(function(e){e.children&&r.push(e)});var t=[];return r.forEach(function(e){t.push(e.id),e.children.forEach(function(e){t.push(e.id)})}),t},fixTreeArray:function(e){console.log("val==>",e)},confirmChange:function(){var e=this;if(!this.fixedRolePermission.length)return this.$Message.success("角色权限修改成功！"),this.refreshPage(),!1;this.permissionWrapper=!0;var r={id:this.roleId,role:this.formValidate.name,description:this.formValidate.roleDscrp,permissions:this.fixedRolePermission};(0,o.addAuditRole)(r).then(function(r){r.code?e.$Message.error("角色权限修改失败！"):(e.$Message.success("角色权限修改成功！"),e.refreshPage()),e.permissionWrapper=!1})},cancelChange:function(){this.$Message.info("已取消修改！")},refreshPageManual:function(){this.refreshPage()},refreshPage:function(e){var r=this;this.ifLoading=!0,(0,o.roleManage)(e).then(function(e){e.code?r.$Message.error(e.msg):(r.userpage=e.data,r.ifLoading=!1)},function(e){console.log(e)})}},created:function(){this.refreshPage({pageNo:1,pageSize:10})}}},400:function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var o=function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("div",[t("Card",[t("p",{attrs:{slot:"title"},slot:"title"},[e._v("\n        角色列表\n          "),t("Button",{attrs:{type:"primary",size:"small"},on:{click:e.refreshPageManual}},[t("Icon",{attrs:{type:"refresh"}}),e._v("\n            刷新\n          ")],1)],1),e._v(" "),t("Row",{staticClass:"functionWrapper"},[t("div",{staticClass:"btnsWrapper clearfix"},[e._v("\n           1111 "),t("Button",{attrs:{type:"primary"},on:{click:e.addRoleBtn}},[e._v("添加角色")])],1)]),e._v(" "),t("Modal",{attrs:{title:"删除角色"},on:{"on-ok":e.deleteRole,"on-cancel":function(r){e.$Message.info("已取消！")}},model:{value:e.delRole,callback:function(r){e.delRole=r},expression:"delRole"}},[t("p",[e._v("是否删除该角色?")])]),e._v(" "),t("Modal",{attrs:{title:"添加角色"},on:{"on-ok":e.addRole},model:{value:e.showAddRole,callback:function(r){e.showAddRole=r},expression:"showAddRole"}},[t("Form",{attrs:{"label-position":"right",model:e.formValidate,"label-width":100,rules:e.ruleValidate}},[t("FormItem",{attrs:{label:"角色名称：",prop:"name"}},[t("Input",{model:{value:e.formValidate.name,callback:function(r){e.$set(e.formValidate,"name",r)},expression:"formValidate.name"}})],1),e._v(" "),t("FormItem",{attrs:{label:"角色描述："}},[t("Input",{attrs:{type:"textarea"},model:{value:e.formValidate.roleDscrp,callback:function(r){e.$set(e.formValidate,"roleDscrp",r)},expression:"formValidate.roleDscrp"}})],1)],1),e._v(" "),t("br"),e._v(" "),t("Tree",{attrs:{data:e.allPermission,"show-checkbox":""},on:{"on-check-change":e.addRoleTree}})],1),e._v(" "),t("Row",[t("Table",{attrs:{columns:e.column_list,data:e.userpage,loading:e.ifLoading,border:""}})],1),e._v(" "),t("Modal",{attrs:{title:"修改权限","mask-closable":!1},on:{"on-ok":e.confirmChange,"on-cancel":e.cancelChange},model:{value:e.showForm,callback:function(r){e.showForm=r},expression:"showForm"}},[t("Form",[t("FormItem",{attrs:{label:"角色描述："}},[t("Input",{attrs:{type:"textarea"},model:{value:e.formValidate.roleDscrp,callback:function(r){e.$set(e.formValidate,"roleDscrp",r)},expression:"formValidate.roleDscrp"}})],1)],1),e._v(" "),t("Tree",{attrs:{data:e.permissions,"show-checkbox":""},on:{"on-check-change":e.fixTreeArray}})],1),e._v(" "),t("Row",{staticClass:"pageWrapper"},[t("Page",{staticClass:"buttomPage",attrs:{total:e.pageNum,current:e.currentPageIdx,"show-elevator":""},on:{"on-change":e.changePage}})],1)],1),e._v(" "),e.permissionWrapper?t("div",{staticClass:"permissionWrapper"},[t("p",[e._v("数据更新中...")])]):e._e()],1)},s=[];o._withStripped=!0;var n={render:o,staticRenderFns:s};r.default=n}});