webpackJsonp([6],{350:function(e,t,r){"use strict";function o(e){l||r(397)}Object.defineProperty(t,"__esModule",{value:!0});var n=r(399),i=r.n(n),s=r(400),a=r.n(s),l=!1,c=r(3),d=o,u=c(i.a,a.a,!1,d,"data-v-012cdff4",null);u.options.__file="src\\views\\html\\system\\role.vue",u.esModule&&Object.keys(u.esModule).some(function(e){return"default"!==e&&"__"!==e.substr(0,2)})&&console.error("named exports are not supported in *.vue files."),t.default=u.exports},397:function(e,t,r){var o=r(398);"string"==typeof o&&(o=[[e.i,o,""]]),o.locals&&(e.exports=o.locals);r(17)("3e6277d4",o,!1)},398:function(e,t,r){t=e.exports=r(16)(void 0),t.push([e.i,"\n.permissionWrapper[data-v-012cdff4] {\n  position: absolute;\n  z-index: 10;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  background-color: rgba(0, 0, 0, 0.2);\n}\n.permissionWrapper p[data-v-012cdff4] {\n  position: absolute;\n  top: 50%;\n  left: 45%;\n  transform: -50%;\n  font-size: 25px;\n  font-style: '\\9ED1\\4F53';\n  text-align: center;\n  color: #fff;\n}\n",""])},399:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r(122),n=r(36);t.default={data:function(){var e=this;return{pageNum:null,currentPageIdx:1,permissionWrapper:!1,ifLoading:!0,deleteRoleArr:[],delRole:!1,deleteRoleID:null,fixedRolePermission:[],submitArr:[],allPermission:[{title:"全部权限",expand:!0,selected:!0,children:[{title:"parent 1-1",expand:!0,children:[{title:"leaf 1-1-2"}]},{title:"parent 1-2",expand:!0,children:[{title:"leaf 1-2-1"},{title:"leaf 1-2-1"}]}]}],roleId:null,showAddRole:!1,showForm:!1,formValidate:{name:null,roleDscrp:null},ruleValidate:{name:[{required:!0,message:"角色名称不能为空!",trigger:"blur"}]},column_list:[{title:"ID",key:"id",width:80},{title:"角色名称",key:"role"},{title:"备注",key:"description"},{title:"操作",render:function(t,r){return t("div",[t("Button",{props:{type:"info",size:"small"},style:{marginRight:"5px"},on:{click:function(){e.permissions=[],e.fixedRolePermission=[],e.showForm=!0,e.filterPermission=[],e.roleId=r.row.id,e.formValidate.name=r.row.role,e.formValidate.roleDscrp=r.row.description;var t=JSON.parse((0,n.getStore)("allPermission"));t.forEach(function(e){e.checked=!1}),(0,o.queryRolePermission)({roleId:r.row.id}).then(function(r){if(r.code)e.$Message.error("数据获取异常！");else{var o=[];r.data.forEach(function(e){e.submenus.forEach(function(e){o.push({id:e.id,parentId:e.parentId})})}),t.forEach(function(e){e.children.forEach(function(e){o.find(function(t){return t.id===e.id})&&(e.checked=!0)})}),e.permissions=t}})}}},"修改"),t("Button",{props:{type:"error",size:"small"},on:{click:function(){e.deleteRoleID=r.row.id,e.delRoleBtn()}}},"删除")])}}],permissions:[],userpage:[]}},methods:{changePage:function(e){this.currentPageIdx=e,this.refreshPage({pageNo:e,pageSize:10})},deleteRole:function(){var e=this;(0,o.deleteRole)({id:this.deleteRoleID}).then(function(t){t.code?e.$Message.error(t.message):(e.$Message.success("删除成功！"),e.refreshPage())})},delRoleBtn:function(){this.delRole=!0},addRoleBtn:function(){var e=this;this.submitArr=[],this.formValidate.roleDscrp=this.formValidate.name=null,this.showAddRole=!0,this.allPermission=JSON.parse((0,n.getStore)("allPermission")),this.allPermission.forEach(function(t,r){e.submitArr.push(t.id),void 0!==t.children&&t.children.forEach(function(t){e.submitArr.push(t.id)})})},addRoleTree:function(e){console.log("www",e)},addRole:function(){var e=this;if(""!==this.formValidate.name&&this.formValidate.name){this.permissionWrapper=!0;var t={role:this.formValidate.name,description:this.formValidate.roleDscrp,permissions:this.submitArr};(0,o.addAuditRole)(t).then(function(t){t.code?e.$Message.error(t.message):(e.$Message.success("操作成功！"),e.refreshPage()),e.permissionWrapper=!1}).catch(function(e){console.log(e)})}else this.$Message.warning("角色名称不能为空！")},selectArrayFn:function(e){var t=[];e.forEach(function(e){e.children&&t.push(e)});var r=[];return t.forEach(function(e){r.push(e.id),e.children.forEach(function(e){r.push(e.id)})}),r},fixTreeArray:function(e){console.log("val==>",e)},confirmChange:function(){var e=this;if(!this.fixedRolePermission.length)return this.$Message.success("角色权限修改成功！"),this.refreshPage(),!1;this.permissionWrapper=!0;var t={id:this.roleId,role:this.formValidate.name,description:this.formValidate.roleDscrp,permissions:this.fixedRolePermission};(0,o.addAuditRole)(t).then(function(t){t.code?e.$Message.error("角色权限修改失败！"):(e.$Message.success("角色权限修改成功！"),e.refreshPage()),e.permissionWrapper=!1})},cancelChange:function(){this.$Message.info("已取消修改！")},getAllPermissionFn:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=[];(0,o.getAllPermission)().then(function(r){r.code||r.data.forEach(function(r){var o={title:r.title,id:r.id,checked:e,children:[]};r.submenus.forEach(function(e){var t={id:e.id,title:e.title,parentId:e.parentId};o.children.push(t)}),t.push(o),(0,n.removeStore)("allPermission"),(0,n.setStore)("allPermission",t)})})},refreshPageManual:function(){this.refreshPage()},refreshPage:function(){var e=this;this.ifLoading=!0,(0,o.roleManage)().then(function(t){t.code?e.$Message.error(t.message):(e.userpage=t.data.content,e.ifLoading=!1)},function(e){console.log(e)})}},created:function(){this.getAllPermissionFn(),this.refreshPage()}}},400:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("Card",[r("p",{attrs:{slot:"title"},slot:"title"},[e._v("\n        角色列表\n          "),r("Button",{attrs:{type:"primary",size:"small"},on:{click:e.refreshPageManual}},[r("Icon",{attrs:{type:"refresh"}}),e._v("\n            刷新\n          ")],1)],1),e._v(" "),r("Row",{staticClass:"functionWrapper"},[r("div",{staticClass:"btnsWrapper clearfix"},[r("Button",{attrs:{type:"primary"},on:{click:e.addRoleBtn}},[e._v("添加角色")])],1)]),e._v(" "),r("Modal",{attrs:{title:"删除角色"},on:{"on-ok":e.deleteRole,"on-cancel":function(t){e.$Message.info("已取消！")}},model:{value:e.delRole,callback:function(t){e.delRole=t},expression:"delRole"}},[r("p",[e._v("是否删除该角色?")])]),e._v(" "),r("Modal",{attrs:{title:"添加角色"},on:{"on-ok":e.addRole},model:{value:e.showAddRole,callback:function(t){e.showAddRole=t},expression:"showAddRole"}},[r("Form",{attrs:{"label-position":"right",model:e.formValidate,"label-width":100,rules:e.ruleValidate}},[r("FormItem",{attrs:{label:"角色名称：",prop:"name"}},[r("Input",{model:{value:e.formValidate.name,callback:function(t){e.$set(e.formValidate,"name",t)},expression:"formValidate.name"}})],1),e._v(" "),r("FormItem",{attrs:{label:"角色描述："}},[r("Input",{attrs:{type:"textarea"},model:{value:e.formValidate.roleDscrp,callback:function(t){e.$set(e.formValidate,"roleDscrp",t)},expression:"formValidate.roleDscrp"}})],1)],1),e._v(" "),r("br"),e._v(" "),r("Tree",{attrs:{data:e.allPermission,"show-checkbox":""},on:{"on-check-change":e.addRoleTree}})],1),e._v(" "),r("Row",[r("Table",{attrs:{columns:e.column_list,data:e.userpage,loading:e.ifLoading,border:""}})],1),e._v(" "),r("Modal",{attrs:{title:"修改权限","mask-closable":!1},on:{"on-ok":e.confirmChange,"on-cancel":e.cancelChange},model:{value:e.showForm,callback:function(t){e.showForm=t},expression:"showForm"}},[r("Form",[r("FormItem",{attrs:{label:"角色描述："}},[r("Input",{attrs:{type:"textarea"},model:{value:e.formValidate.roleDscrp,callback:function(t){e.$set(e.formValidate,"roleDscrp",t)},expression:"formValidate.roleDscrp"}})],1)],1),e._v(" "),r("Tree",{attrs:{data:e.permissions,"show-checkbox":""},on:{"on-check-change":e.fixTreeArray}})],1),e._v(" "),r("Row",{staticClass:"pageWrapper"},[r("Page",{staticClass:"buttomPage",attrs:{total:e.pageNum,current:e.currentPageIdx,"show-elevator":""},on:{"on-change":e.changePage}})],1)],1),e._v(" "),e.permissionWrapper?r("div",{staticClass:"permissionWrapper"},[r("p",[e._v("数据更新中...")])]):e._e()],1)},n=[];o._withStripped=!0;var i={render:o,staticRenderFns:n};t.default=i}});